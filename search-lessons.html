<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Search Information ‚Ä¢ GoldenSpaceAI</title>
  <style>
    :root{
      --bg:#0b1020;
      --panel:#121831;
      --panel-2:#0f1530;
      --accent:#f7c948;
      --accent-2:#f0b429;
      --text:#fdf7e7;
      --subtle:#d9cfae;
      --border:#262f55;
      --chip:#151e3b;
      --blue-ink:#a6b9ff;
    }
    *{box-sizing:border-box}
    body{
      margin:0;min-height:100svh;color:var(--text);
      background:
        radial-gradient(1200px 600px at 80% -10%,rgba(247,201,72,.08),transparent 60%),
        radial-gradient(1200px 700px at -10% 10%,rgba(166,185,255,.08),transparent 55%),
        var(--bg);
      font-family:ui-sans-serif,system-ui,"Segoe UI",Roboto,Helvetica,Arial;
    }
    .top{
      position:sticky;top:0;z-index:10;
      background:linear-gradient(180deg,rgba(11,16,32,.95),rgba(11,16,32,.72)60%,transparent);
      backdrop-filter:blur(8px);
      padding:clamp(16px,2.5vh,24px)18px 10px;
      display:flex;align-items:center;gap:12px;
    }
    .back{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 14px;border-radius:999px;text-decoration:none;
      background:var(--accent);color:#2c2100;font-weight:800;font-size:14px;
      border:1px solid rgba(0,0,0,.12);
      box-shadow:0 6px 22px rgba(247,201,72,.25);
      transition:transform .2s ease,background .2s ease;
    }
    .back:hover{background:var(--accent-2);transform:translateY(-1px);}
    .title{
      font-size:clamp(22px,2.7vw,28px);font-weight:900;letter-spacing:.35px;
      color:var(--accent);text-shadow:0 0 18px rgba(247,201,72,.25);
    }
    .spacer{flex:1}
    .wrap{max-width:1000px;margin:0 auto;padding:8px 16px 120px;}
    /* ---------- GOLDEN LOCK OVERLAY ---------- */
    .golden-overlay{
      position:fixed;top:0;left:0;width:100%;height:100%;
      background:rgba(11,16,32,0.95);
      backdrop-filter:blur(10px);
      display:flex;align-items:center;justify-content:center;
      z-index:1000;
    }
    .golden-unlock{
      background:linear-gradient(180deg,var(--panel),var(--panel-2));
      border:2px solid rgba(247,201,72,0.3);
      border-radius:20px;
      padding:30px;text-align:center;
      max-width:500px;width:90%;
      box-shadow:0 25px 80px rgba(0,0,0,.8);
    }
    .golden-unlock .icon{font-size:64px;margin-bottom:20px;}
    .golden-unlock h2{color:var(--accent);margin:0 0 15px;font-size:28px;}
    .golden-unlock .description{color:var(--subtle);margin-bottom:25px;line-height:1.6;font-size:16px;}
    .golden-unlock .price{
      font-size:42px;font-weight:900;color:var(--accent);
      margin:20px 0;text-shadow:0 0 15px rgba(247,201,72,0.6);
    }
    .golden-unlock .price span{font-size:18px;color:var(--subtle);}
    .unlock-btn{
      background:linear-gradient(180deg,var(--accent),var(--accent-2));
      color:#2c2100;border:none;border-radius:14px;
      padding:16px 40px;font-weight:900;font-size:18px;
      cursor:pointer;box-shadow:0 12px 35px rgba(247,201,72,0.5);
      transition:all 0.3s ease;margin:15px 0;width:100%;
    }
    .unlock-btn:hover:not(:disabled){
      transform:translateY(-3px);
      box-shadow:0 18px 45px rgba(247,201,72,0.7);
    }
    .unlock-btn:disabled{opacity:.6;cursor:not-allowed;}
    .time-remaining{
      background:rgba(247,201,72,0.15);
      border:1px solid rgba(247,201,72,0.3);
      border-radius:12px;padding:15px;margin:20px 0;font-size:15px;
    }
    .time-remaining .label{color:var(--subtle);font-size:13px;margin-bottom:6px;}
    .time-remaining .time{
      color:var(--accent);font-weight:900;font-size:22px;
      text-shadow:0 0 10px rgba(247,201,72,0.5);
    }
    .balance-info{color:var(--subtle);font-size:14px;margin:10px 0;}
    .balance-info .golden-amount{color:var(--accent);font-weight:800;}
    .status-message{margin:15px 0;padding:10px;border-radius:8px;font-size:14px;}
    .status-success{background:rgba(144,238,144,0.1);border:1px solid rgba(144,238,144,0.3);color:#90ee90;}
    .status-error{background:rgba(255,107,107,0.1);border:1px solid rgba(255,107,107,0.3);color:#ff6b6b;}
    /* ---------- SEARCH UI ---------- */
    .searchBox{display:flex;gap:10px;align-items:center;
      border:1px solid var(--border);border-radius:16px;
      background:linear-gradient(180deg,var(--panel),var(--panel-2));
      padding:10px;box-shadow:0 20px 60px rgba(0,0,0,.45);}
    .searchBox input{flex:1;background:transparent;border:0;outline:0;
      color:var(--text);font-size:16px;padding:12px;}
    .btn{background:var(--accent);color:#2c2100;font-weight:800;
      border:0;border-radius:12px;padding:10px 16px;cursor:pointer;
      box-shadow:0 10px 26px rgba(247,201,72,.3);
      transition:transform .2s ease,background .2s ease;}
    .btn:hover{background:var(--accent-2);transform:translateY(-1px);}
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin:14px 2px 18px;}
    .chip{padding:8px 12px;background:var(--chip);border:1px solid var(--border);
      color:var(--blue-ink);border-radius:999px;font-size:13px;cursor:pointer;
      transition:background .2s ease,transform .15s ease;}
    .chip:hover{background:#1a264d;transform:translateY(-1px);}
    .panel{border:1px solid var(--border);
      background:linear-gradient(180deg,var(--panel),var(--panel-2));
      border-radius:16px;overflow:hidden;
      box-shadow:0 20px 80px rgba(0,0,0,.45);}
    .resultsHead{display:flex;align-items:center;justify-content:space-between;
      padding:14px 16px;border-bottom:1px solid var(--border);}
    .muted{color:var(--subtle);font-size:13px;}
    .results{padding:10px;}
    .card{border:1px solid var(--border);background:#101a37;border-radius:14px;padding:14px;margin:10px 0;box-shadow:0 10px 28px rgba(0,0,0,.35);}
    .card h3{margin:0 0 6px;font-size:18px;letter-spacing:.2px;color:var(--accent);}
    .card p{margin:0;color:#f6edd3;line-height:1.55;}
    .badge{font-size:11px;padding:4px 8px;border-radius:999px;letter-spacing:.3px;
      border:1px solid var(--border);color:#ffe9a6;background:#1b254b;}
    .badges{display:flex;gap:6px;margin-top:10px;}
    .footnote{text-align:center;margin-top:16px;color:var(--subtle);font-size:12px;}
    .hidden{display:none;}
  </style>
</head>
<body>
  <div class="top">
    <a class="back" href="/"><span>‚Üê</span> Home</a>
    <div class="title">Search Information</div>
    <div class="spacer"></div>
  </div>

  <div class="wrap">
    <!-- Lock -->
    <div id="goldenOverlay" class="golden-overlay">
      <div class="golden-unlock">
        <div class="icon">üîí</div>
        <h2>Unlock Search Information</h2>
        <p class="description">Access advanced AI search with complete summaries & insights for 30 days.</p>
        <div class="price">10G <span>per month</span></div>
        <div class="balance-info">
          Your balance: <span id="userBalance" class="golden-amount">0G</span>
        </div>
        <div id="timeRemaining" class="time-remaining hidden">
          <div class="label">TIME REMAINING</div>
          <div class="time" id="remainingTime">720 hours left</div>
        </div>
        <button id="unlockBtn" class="unlock-btn">UNLOCK FOR 10G / MONTH</button>
        <div id="statusMessage" class="status-message"></div>
        <div style="margin-top:20px;">
          <a href="/buy-golden.html" style="color:var(--accent);text-decoration:none;font-weight:600;">üí∞ Need more Golden? Buy here ‚Üí</a>
        </div>
      </div>
    </div>

    <!-- Interface -->
    <div id="searchInterface">
      <div class="searchBox">
        <input id="q" type="text" placeholder="Search GoldenSpaceAI‚Ä¶" autofocus />
        <button id="go" class="btn">Search</button>
      </div>

      <div class="chips" id="chips">
        <button class="chip">Planets</button><button class="chip">Black holes</button>
        <button class="chip">Exoplanets</button><button class="chip">James Webb discoveries</button>
        <button class="chip">Rocket equation</button><button class="chip">Orbit types</button>
        <button class="chip">Dark matter</button><button class="chip">Astrobiology</button>
      </div>

      <div class="panel">
        <div class="resultsHead">
          <div class="muted" id="status">Type a query or pick a topic.</div>
          <div class="muted" id="count"></div>
        </div>
        <div id="results" class="results"></div>
      </div>
      <div class="footnote">Results are AI-generated summaries. Verify important facts.</div>
    </div>
  </div>

  <script>
    const FEATURE_NAME='search_info';
    const FEATURE_COST=10;
    const UNLOCK_HOURS=720; // 30 days

    const overlay=document.getElementById('goldenOverlay');
    const ui=document.getElementById('searchInterface');
    const userBalanceEl=document.getElementById('userBalance');
    const timeBox=document.getElementById('timeRemaining');
    const timeEl=document.getElementById('remainingTime');
    const unlockBtn=document.getElementById('unlockBtn');
    const msg=document.getElementById('statusMessage');

    async function init(){
      try{
        const u=await fetch('/api/me',{credentials:'include'}).then(r=>r.json());
        if(!u.loggedIn){showMsg('Please log in to use this feature.','error');return;}
        const b=await fetch('/api/golden-balance',{credentials:'include'}).then(r=>r.json());
        userBalanceEl.textContent=b.balance+'G';
        const f=await fetch(`/api/feature-status?feature=${FEATURE_NAME}`,{credentials:'include'}).then(r=>r.json());
        if(f.unlocked){unlockUI(f.remainingHours);}else{overlay.style.display='flex';ui.style.display='none';}
      }catch(e){showMsg('Error loading page.','error');}
    }

    async function unlock(){
      unlockBtn.disabled=true;showMsg('Processing...','');
      try{
        const r=await fetch('/api/unlock-feature',{
          method:'POST',
          headers:{'Content-Type':'application/json'},
          credentials:'include',
          body:JSON.stringify({feature:FEATURE_NAME,cost:FEATURE_COST})
        });
        const d=await r.json();
        if(d.success){
          showMsg('‚úÖ Unlocked for 30 days.','success');
          userBalanceEl.textContent=d.newBalance+'G';
          setTimeout(()=>unlockUI(UNLOCK_HOURS),1200);
        }else{showMsg('‚ùå '+(d.error||'Unlock failed'), 'error');unlockBtn.disabled=false;}
      }catch(e){showMsg('‚ùå Network error.','error');unlockBtn.disabled=false;}
    }

    function unlockUI(hours){
      overlay.style.display='none';ui.style.display='block';
      if(hours>0){timeBox.classList.remove('hidden');updateTime(hours);countdown(hours);}
    }
    function updateTime(h){const d=Math.floor(h/24),hr=h%24;timeEl.textContent=`${d}d ${hr}h left`;}
    function countdown(h){let left=h;const t=setInterval(()=>{left--;if(left<=0){clearInterval(t);location.reload();}else updateTime(left);},3600000);}
    function showMsg(t,type){msg.textContent=t;msg.className='status-message';if(type==='success')msg.classList.add('status-success');if(type==='error')msg.classList.add('status-error');}
    unlockBtn.addEventListener('click',unlock);

    // --- Search ---
    const q=document.getElementById('q'),go=document.getElementById('go'),res=document.getElementById('results'),status=document.getElementById('status'),count=document.getElementById('count');
    document.getElementById('chips').addEventListener('click',e=>{if(e.target.classList.contains('chip')){q.value=e.target.textContent;search();}});
    go.addEventListener('click',search);q.addEventListener('keydown',e=>{if(e.key==='Enter')search();});
    function loading(){res.innerHTML='<div class="card"><p>Loading...</p></div>';status.textContent='Searching‚Ä¶';count.textContent='';}
    async function search(){
      const query=q.value.trim();if(!query)return;loading();go.disabled=true;
      try{
        const r=await fetch('/search-info',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({query:`Give a concise summary of: ${query}.`})});
        const d=await r.json();const t=d.answer||d.reply||'';const parts=t.split(/\n{2,}/).filter(Boolean);
        res.innerHTML=parts.map((p,i)=>`<div class="card"><h3>${i===0?'Overview':'Detail '+i}</h3><p>${p}</p><div class="badges"><span class="badge">AI summary</span><span class="badge">GoldenSpaceAI</span></div></div>`).join('');
        status.textContent='Completed';count.textContent=parts.length+' sections';
      }catch(e){res.innerHTML='<div class="card"><p style="color:#ffd27a">Error: '+e.message+'</p></div>';status.textContent='Failed';}
      finally{go.disabled=false;}
    }

    init();
  </script>
</body>
</html>
