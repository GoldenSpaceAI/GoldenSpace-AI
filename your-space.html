<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Space | Gravitational Sandbox | GoldenSpaceAI</title>
    <style>
        :root {
            --bg-dark: #0a0e15;
            --panel-bg: #101828;
            --border-color: #334155;
            --text-primary: #E2E8F0;
            --text-secondary: #94A3B8;
            --gold-accent: #f6c64a;
            --gold-glow: rgba(246, 198, 74, 0.2);
        }

        body {
            font-family: 'Segoe UI', 'Roboto', system-ui, sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-primary);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* --- Toolbox Panel --- */
        .toolbox {
            width: 300px;
            background-color: var(--panel-bg);
            border-right: 1px solid var(--border-color);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            z-index: 10;
        }
        .toolbox h2 {
            color: var(--gold-accent);
            margin-top: 0;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.75rem;
        }
        .tool-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            border-radius: 6px;
            margin-bottom: 1rem;
            cursor: pointer;
            border: 1px solid var(--border-color);
            transition: all 0.2s ease;
        }
        .tool-item:hover {
            border-color: var(--gold-accent);
            background-color: #1E293B;
        }
        .tool-item-icon { font-size: 2rem; line-height: 1; }
        .tool-item h3 { margin: 0; font-size: 1rem; }
        
        /* --- Inspector Panel --- */
        #inspector-panel {
            margin-top: auto;
            background-color: var(--bg-dark);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            display: none; /* Initially hidden */
        }
        .inspector-group { margin-bottom: 1rem; }
        .inspector-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }
        .inspector-group input, .inspector-group select {
            width: 100%;
            background-color: var(--panel-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem;
            border-radius: 4px;
            box-sizing: border-box;
        }
        #advanced-planet-settings { display: none; } /* Hidden by default */

        /* --- Universe Canvas --- */
        .universe-canvas {
            flex: 1;
            position: relative;
            background-color: var(--bg-dark);
            overflow: hidden;
        }

        /* Celestial Objects */
        .celestial-object {
            position: absolute;
            cursor: grab;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: box-shadow 0.2s, width 0.3s, height 0.3s;
        }
        .celestial-object.selected {
            box-shadow: 0 0 20px 5px var(--gold-glow), 0 0 0 2px var(--gold-accent);
            z-index: 100;
        }
        .celestial-object.dragging { cursor: grabbing; z-index: 101; }

        /* Specific Object Styles */
        .galaxy {
            width: 250px;
            height: 250px;
            background: radial-gradient(ellipse, #fff 0%, rgba(255,255,255,0.6) 10%, rgba(255,255,255,0) 60%);
        }
        .star {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, #fff, var(--gold-accent));
            box-shadow: 0 0 40px var(--gold-accent);
        }
        .planet {
            width: 20px;
            height: 20px;
            background-color: #38bdf8;
            z-index: 50;
        }
        .orbit-path {
            position: absolute;
            border: 1px dashed var(--border-color);
            border-radius: 50%;
            pointer-events: none; /* Allows clicking through it */
            transition: width 0.3s, height 0.3s, top 0.3s, left 0.3s;
        }
    </style>
</head>
<body>

    <main class="universe-canvas" id="universe-canvas">
        </main>

    <aside class="toolbox">
        <div>
            <h2>Toolbox</h2>
            <div class="tool-item" data-type="galaxy"><div class="tool-item-icon">üåå</div><h3>Add Galaxy</h3></div>
            <div class="tool-item" data-type="star"><div class="tool-item-icon">üåü</div><h3>Add Star</h3></div>
            <div class="tool-item" data-type="planet"><div class="tool-item-icon">ü™ê</div><h3>Add Planet</h3></div>
        </div>
        
        <div id="inspector-panel">
            <h3>Inspector</h3>
            <div class="inspector-group">
                <label for="name-input">Object Name</label>
                <input type="text" id="name-input">
            </div>
            <div id="advanced-planet-settings">
                 <div class="inspector-group">
                    <label for="size-input">Planet Size</label>
                    <input type="range" id="size-input" min="10" max="80" value="20">
                </div>
                <div class="inspector-group">
                    <label for="color-input">Planet Color</label>
                    <input type="color" id="color-input" value="#38bdf8">
                </div>
                <div class="inspector-group">
                    <label for="oxygen-input">Oxygen Level</label>
                    <input type="text" id="oxygen-input" value="21%">
                </div>
                <div class="inspector-group">
                    <label for="life-input">Type of Life</label>
                    <select id="life-input">
                        <option>None</option>
                        <option>Microbial</option>
                        <option>Complex (Flora/Fauna)</option>
                        <option>Intelligent</option>
                    </select>
                </div>
            </div>
        </div>
    </aside>

    <script>
        const canvas = document.getElementById('universe-canvas');
        const toolboxItems = document.querySelectorAll('.tool-item');
        const inspectorPanel = document.getElementById('inspector-panel');
        const nameInput = document.getElementById('name-input');
        const advancedSettings = document.getElementById('advanced-planet-settings');
        const sizeInput = document.getElementById('size-input');
        const colorInput = document.getElementById('color-input');
        const oxygenInput = document.getElementById('oxygen-input');
        const lifeInput = document.getElementById('life-input');

        let activeObject = null;
        let objectCounter = 0;
        let objects = new Map();

        // --- ADDING OBJECTS ---
        toolboxItems.forEach(item => {
            item.addEventListener('click', () => createObject(item.dataset.type, { x: 200, y: 200 }));
        });

        function createObject(type, position) {
            objectCounter++;
            const id = `obj-${objectCounter}`;
            const objEl = document.createElement('div');
            objEl.className = `celestial-object ${type}`;
            objEl.id = id;
            objEl.style.left = `${position.x}px`;
            objEl.style.top = `${position.y}px`;

            const objectData = {
                id: id,
                el: objEl,
                type: type,
                name: `${type.charAt(0).toUpperCase() + type.slice(1)} ${objectCounter}`,
            };
            
            if (type === 'planet') {
                objectData.size = 20;
                objectData.color = '#38bdf8';
                objectData.oxygen = '21%';
                objectData.life = 'None';
                objectData.orbitalAngle = Math.random() * 360;
                objectData.orbitSpeed = (Math.random() * 0.2) + 0.1;
                // Create an orbit path for the planet
                const orbitEl = document.createElement('div');
                orbitEl.className = 'orbit-path';
                canvas.appendChild(orbitEl);
                objectData.orbitEl = orbitEl;
            }

            objects.set(id, objectData);
            
            makeDraggable(objectData);
            objEl.addEventListener('click', e => { e.stopPropagation(); selectObject(objectData); });
            canvas.appendChild(objEl);
            selectObject(objectData);
            
            if (type === 'planet') updatePlanetOrbit(objectData);
        }
        
        // --- SELECTING & INSPECTING ---
        function selectObject(objData) {
            if (activeObject && activeObject.el) activeObject.el.classList.remove('selected');
            
            activeObject = objData;
            activeObject.el.classList.add('selected');

            inspectorPanel.style.display = 'block';
            nameInput.value = activeObject.name;
            
            if (activeObject.type === 'planet') {
                advancedSettings.style.display = 'block';
                sizeInput.value = activeObject.size;
                colorInput.value = activeObject.color;
                oxygenInput.value = activeObject.oxygen;
                lifeInput.value = activeObject.life;
            } else {
                advancedSettings.style.display = 'none';
            }
        }
        
        // Inspector event listeners
        nameInput.addEventListener('input', () => { if (activeObject) activeObject.name = nameInput.value; });
        sizeInput.addEventListener('input', () => { if (activeObject?.type === 'planet') {
            activeObject.size = parseFloat(sizeInput.value);
            activeObject.el.style.width = `${activeObject.size}px`;
            activeObject.el.style.height = `${activeObject.size}px`;
        }});
        colorInput.addEventListener('input', () => { if (activeObject?.type === 'planet') {
            activeObject.color = colorInput.value;
            activeObject.el.style.backgroundColor = activeObject.color;
        }});
        oxygenInput.addEventListener('input', () => { if (activeObject?.type === 'planet') activeObject.oxygen = oxygenInput.value; });
        lifeInput.addEventListener('change', () => { if (activeObject?.type === 'planet') activeObject.life = lifeInput.value; });

        // --- ORBIT & GRAVITY SIMULATION ---
        function getCenter(data) {
            return {
                x: data.el.offsetLeft + data.el.offsetWidth / 2,
                y: data.el.offsetTop + data.el.offsetHeight / 2
            };
        }

        function updatePlanetOrbit(planetData) {
            let nearestStar = null;
            let minDistance = Infinity;

            objects.forEach(obj => {
                if (obj.type === 'star') {
                    const planetCenter = getCenter(planetData);
                    const starCenter = getCenter(obj);
                    const distance = Math.hypot(planetCenter.x - starCenter.x, planetCenter.y - starCenter.y);
                    if (distance < minDistance) {
                        minDistance = distance;
                        nearestStar = obj;
                    }
                }
            });

            if (nearestStar) {
                planetData.anchorStar = nearestStar;
                planetData.orbitRadius = minDistance;
                
                // Update visual orbit path
                const orbitSize = minDistance * 2;
                const starCenter = getCenter(nearestStar);
                planetData.orbitEl.style.width = `${orbitSize}px`;
                planetData.orbitEl.style.height = `${orbitSize}px`;
                planetData.orbitEl.style.left = `${starCenter.x - minDistance}px`;
                planetData.orbitEl.style.top = `${starCenter.y - minDistance}px`;
                planetData.orbitEl.style.display = 'block';
            } else {
                // No star nearby, hide orbit
                planetData.anchorStar = null;
                planetData.orbitEl.style.display = 'none';
            }
        }

        function animate() {
            objects.forEach(obj => {
                if (obj.type === 'planet' && obj.anchorStar) {
                    obj.orbitalAngle += obj.orbitSpeed;
                    const starCenter = getCenter(obj.anchorStar);
                    
                    const newX = starCenter.x + obj.orbitRadius * Math.cos(obj.orbitalAngle * Math.PI / 180) - obj.size / 2;
                    const newY = starCenter.y + obj.orbitRadius * Math.sin(obj.orbitalAngle * Math.PI / 180) - obj.size / 2;

                    obj.el.style.left = `${newX}px`;
                    obj.el.style.top = `${newY}px`;
                }
            });
            requestAnimationFrame(animate);
        }

        // --- DRAGGING LOGIC ---
        function makeDraggable(elementData) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            const element = elementData.el;

            element.onmousedown = dragMouseDown;

            function dragMouseDown(e) {
                e.preventDefault();
                e.stopPropagation();
                selectObject(elementData);

                pos3 = e.clientX;
                pos4 = e.clientY;
                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
                element.classList.add('dragging');
                if(elementData.orbitEl) elementData.orbitEl.style.display = 'none';
            }

            function elementDrag(e) {
                e.preventDefault();
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;

                element.style.top = (element.offsetTop - pos2) + "px";
                element.style.left = (element.offsetLeft - pos1) + "px";
            }

            function closeDragElement() {
                document.onmouseup = null;
                document.onmousemove = null;
                element.classList.remove('dragging');
                if (elementData.type === 'planet') {
                    updatePlanetOrbit(elementData);
                }
                // If a star was moved, re-calculate orbits for all planets
                if (elementData.type === 'star') {
                    objects.forEach(obj => { if(obj.type === 'planet') updatePlanetOrbit(obj); });
                }
            }
        }

        // --- INITIALIZATION ---
        animate(); // Start the simulation loop
    </script>
</body>
</html>
